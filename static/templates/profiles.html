<div x-data="profilesData">
  <template x-if="loading">
    <jinya-loader></jinya-loader>
  </template>
  <template x-if="!loading">
    <div class="cosmo-side-list">
      <nav class="cosmo-side-list__items">
        <template x-for="profile in profiles">
          <a
            @click="selectProfile(profile)"
            class="cosmo-side-list__item"
            x-active="selectedProfile?.id === profile.id"
            x-text="profile.linkLabel"
          >
          </a>
        </template>
        <button @click="addProfile.openDialog()" class="cosmo-button is--full-width">
          Add profile
        </button>
      </nav>
      <template x-if="selectedProfile">
        <div class="cosmo-side-list__content">
          <div class="cosmo-toolbar">
            <div class="cosmo-toolbar__group">
              <button class="cosmo-button" @click="editProfile.openDialog(selectedProfile)">Edit</button>
              <button class="cosmo-button" @click="deleteProfile">Delete</button>
            </div>
          </div>
          <dl class="cosmo-list is--key-value is--profile">
            <dt>Link label</dt>
            <dd x-text="selectedProfile.linkLabel"></dd>
            <dt>Link target</dt>
            <dd x-text="selectedProfile.linkTarget"></dd>
            <dt>Description</dt>
          </dl>
          <div x-html="selectedProfile.description"></div>
        </div>
      </template>
    </div>
  </template>
  <template x-if="addProfile.open">
    <div class="cosmo-modal__container">
      <form class="cosmo-modal" @submit.prevent="createProfile">
        <h1 class="cosmo-modal__title">Create profile</h1>
        <div class="cosmo-modal__content is--jodit">
          <div class="cosmo-input__group">
            <label for="linkLabel" class="cosmo-label">Link label</label>
            <input type="text" id="linkLabel" class="cosmo-input" x-model="addProfile.linkLabel" required>
            <label for="linkTarget" class="cosmo-label">Link target</label>
            <input type="url" id="linkTarget" class="cosmo-input" x-model="addProfile.linkTarget" required>
          </div>
          <jinya-toolbar-editor
            height="30rem"
            :content="addProfile.description"
            @change="(e) => addProfile.description = e.value"
          />
        </div>
        <div class="cosmo-modal__button-bar">
          <button class="cosmo-button" type="button" @click="addProfile.open = false">Discard profile</button>
          <button class="cosmo-button" type="submit">Create profile</button>
        </div>
      </form>
    </div>
  </template>
  <template x-if="editProfile.open">
    <div class="cosmo-modal__container">
      <form class="cosmo-modal" @submit.prevent="saveProfile">
        <h1 class="cosmo-modal__title">Edit profile</h1>
        <div class="cosmo-modal__content is--jodit">
          <div class="cosmo-input__group">
            <label for="linkLabel" class="cosmo-label">Link label</label>
            <input type="text" id="linkLabel" class="cosmo-input" x-model="editProfile.linkLabel" required>
            <label for="linkTarget" class="cosmo-label">Link target</label>
            <input type="url" id="linkTarget" class="cosmo-input" x-model="editProfile.linkTarget" required>
          </div>
          <jinya-toolbar-editor
            height="30rem"
            :content="editProfile.description"
            @change="(e) => editProfile.description = e.value"
          />
        </div>
        <div class="cosmo-modal__button-bar">
          <button class="cosmo-button" type="button" @click="editProfile.open = false">Discard changes</button>
          <button class="cosmo-button" type="submit">Save profile</button>
        </div>
      </form>
    </div>
  </template>
</div>
